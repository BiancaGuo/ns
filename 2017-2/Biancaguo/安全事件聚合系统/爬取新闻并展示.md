## 安全新闻聚合系统 之 爬取安全类新闻并进行页面展示

### 一、爬虫的编写

* 使用了pyspider框架

（1）pyspider优势

	* 支持多线程爬取、
	* 支持JS动态解析
	* 提供了可操作界面、出错重试、定时爬取等等的功能
	
（2）pyspider配置

	* 安装pyspider：终端输入命令 pip install pyspider 
	* 配置phantomJs：能够支持JS动态解析：去官网下载phantomJs：http://phantomjs.org/download.html解压后把bin文件夹添加到系统的环境变量里，重新运行pyspider显示phantomJs安装成功。
	* 访问http://localhost:5000/，pyspider控制面板如下，创建项目后进行爬虫程序编写，保存后回到主面板点击运行：

![](https://i.imgur.com/wMFkiC2.jpg)

* 爬取新闻页面（暂以爬取36氪网站为例）

（1）36氪网站快讯专栏页面十分适合进行爬取

![](https://i.imgur.com/QcosBlO.jpg)

（2）查看页面源代码，并没有我们需要的文章信息，打开开发者工具进行查看，发现调用了接口api

![](https://i.imgur.com/y3lus6j.jpg)

![](https://i.imgur.com/bWCtZJM.jpg)

（3）编写pyspider程序，爬取该json格式的页面，提取关键信息

（4）重写pyspider中的insert_result方法，将重写后的方法导入主爬虫程序中使抓取到的数据存入我们在mysql数据库创建的表中

	from pyspider.libs.result_mysql import insert_result #引入编写的数据库配置文件，不使用pyspider默认数据库，而将抓取结果放入指定mysql表中

* 数据库中表结构及存储内容

![](https://i.imgur.com/PDrrm4o.jpg)

![](https://i.imgur.com/tKbBhQj.jpg)

### 二、爬取结果在网站中展示

* 编写php程序，使用pdo操作数据库

![](https://i.imgur.com/eQp9EMu.jpg)

![](https://i.imgur.com/NZkWE3G.jpg)

![](https://i.imgur.com/Y9juZ5L.jpg)

### 三、下一步目标

* 将爬取的多个网站的数据进行分类显示
*
* 将相同新闻进行聚合